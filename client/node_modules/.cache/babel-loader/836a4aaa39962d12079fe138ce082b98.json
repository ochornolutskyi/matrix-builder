{"ast":null,"code":"import _objectSpread from\"/home/superproger/workspace/matrix-builder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/home/superproger/workspace/matrix-builder/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import{INCREMENT_CELL,REMOVE_ROW,ADD_ROW,SET_NEAREST_IDS,RESET_NEAREST_IDS,SET_SETTINGS,RESET_SETTINGS}from\"../../action_types\";import{createMatrix,rebuildMatrix,addRows}from\"./buildingMatrix\";import defaultState from\"./defaultState\";import getIds from\"./findNearestIds\";var initialState=defaultState;var sortData=function sortData(data){return data.flat().sort(function(a,b){return a.value-b.value;});};var checkMatrixData=function checkMatrixData(data,settings,newSettings){if(data.length===0){return createMatrix(newSettings.rowsCount,newSettings.columnsCount);}else if(settings.rowsCount!==newSettings.rowsCount||settings.columnsCount!==newSettings.columnsCount){return rebuildMatrix(data,settings,newSettings);}else{return data;}};var getNearestIds=function getNearestIds(data,cellsCount,id){return!!cellsCount?getIds(data,cellsCount,id):defaultState.nearestIds;};var matrixReducer=function matrixReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;var data,sortedData,settings;switch(action.type){case SET_SETTINGS:data=checkMatrixData(_toConsumableArray(state.data),state.settings,action.settings);return _objectSpread(_objectSpread({},state),{},{data:data,sortedData:sortData(data),settings:action.settings});case RESET_SETTINGS:return{defaultState:defaultState};case ADD_ROW:data=addRows(_toConsumableArray(state.data),1,state.settings.columnsCount);settings=_objectSpread(_objectSpread({},state.settings),{},{rowsCount:data.length});return _objectSpread(_objectSpread({},state),{},{settings:settings,data:data,sortedData:sortData(data)});case REMOVE_ROW:data=state.data.filter(function(row,index){return index!==action.rowIndex;});settings=_objectSpread(_objectSpread({},state.settings),{},{rowsCount:state.data.length});return _objectSpread(_objectSpread({},state),{},{settings:settings,data:data,sortedData:sortData(data)});case INCREMENT_CELL:data=_toConsumableArray(state.data);var incrementValue=data.flat().find(function(item){return item.id===action.id;}).value;incrementValue<999&&data.find(function(row){return row.find(function(item){return item.id===action.id?item.value++:null;});});sortedData=sortData(data);return _objectSpread(_objectSpread({},state),{},{data:data,sortedData:sortedData,nearestIds:getNearestIds(sortedData,state.settings.cellsCount,action.id)});case SET_NEAREST_IDS:if(state.settings.cellsCount>0){return _objectSpread(_objectSpread({},state),{},{nearestIds:getNearestIds(state.sortedData,state.settings.cellsCount,action.id)});}else{return _objectSpread({},state);}case RESET_NEAREST_IDS:if(!!state.nearestIds.ids.length){return _objectSpread(_objectSpread({},state),{},{nearestIds:defaultState.nearestIds});}else{return _objectSpread({},state);}default:return defaultState;}};export default matrixReducer;","map":{"version":3,"sources":["/home/superproger/workspace/matrix-builder/client/src/redux/reducers/matrixReducer/index.js"],"names":["INCREMENT_CELL","REMOVE_ROW","ADD_ROW","SET_NEAREST_IDS","RESET_NEAREST_IDS","SET_SETTINGS","RESET_SETTINGS","createMatrix","rebuildMatrix","addRows","defaultState","getIds","initialState","sortData","data","flat","sort","a","b","value","checkMatrixData","settings","newSettings","length","rowsCount","columnsCount","getNearestIds","cellsCount","id","nearestIds","matrixReducer","state","action","sortedData","type","filter","row","index","rowIndex","incrementValue","find","item","ids"],"mappings":"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","sourcesContent":["import {\n   INCREMENT_CELL,\n   REMOVE_ROW,\n   ADD_ROW,\n   SET_NEAREST_IDS,\n   RESET_NEAREST_IDS,\n   SET_SETTINGS,\n   RESET_SETTINGS,\n} from \"../../action_types\";\nimport { createMatrix, rebuildMatrix, addRows } from \"./buildingMatrix\";\nimport defaultState from \"./defaultState\";\nimport getIds from \"./findNearestIds\";\n\nconst initialState = defaultState;\nconst sortData = (data) => data.flat().sort((a, b) => a.value - b.value);\n\nconst checkMatrixData = (data, settings, newSettings) => {\n   if (data.length === 0) {\n      return createMatrix(newSettings.rowsCount, newSettings.columnsCount);\n   } else if (\n      settings.rowsCount !== newSettings.rowsCount ||\n      settings.columnsCount !== newSettings.columnsCount\n   ) {\n      return rebuildMatrix(data, settings, newSettings);\n   } else {\n      return data;\n   }\n};\nconst getNearestIds = (data, cellsCount, id) =>\n   !!cellsCount ? getIds(data, cellsCount, id) : defaultState.nearestIds;\n\nconst matrixReducer = (state = initialState, action) => {\n   let data, sortedData, settings;\n   switch (action.type) {\n      case SET_SETTINGS:\n         data = checkMatrixData(\n            [...state.data],\n            state.settings,\n            action.settings\n         );\n         return {\n            ...state,\n            data,\n            sortedData: sortData(data),\n            settings: action.settings,\n         };\n      case RESET_SETTINGS:\n         return {\n            defaultState,\n         };\n      case ADD_ROW:\n         data = addRows([...state.data], 1, state.settings.columnsCount);\n         settings = { ...state.settings, rowsCount: data.length };\n         return {\n            ...state,\n            settings,\n            data,\n            sortedData: sortData(data),\n         };\n      case REMOVE_ROW:\n         data = state.data.filter((row, index) => index !== action.rowIndex);\n         settings = { ...state.settings, rowsCount: state.data.length };\n         return {\n            ...state,\n            settings,\n            data,\n            sortedData: sortData(data),\n         };\n      case INCREMENT_CELL:\n         data = [...state.data];\n         const incrementValue = data\n            .flat()\n            .find((item) => item.id === action.id).value;\n         incrementValue < 999 &&\n            data.find((row) =>\n               row.find((item) => (item.id === action.id ? item.value++ : null))\n            );\n         sortedData = sortData(data);\n         return {\n            ...state,\n            data,\n            sortedData,\n            nearestIds: getNearestIds(\n               sortedData,\n               state.settings.cellsCount,\n               action.id\n            ),\n         };\n      case SET_NEAREST_IDS:\n         if (state.settings.cellsCount > 0) {\n            return {\n               ...state,\n               nearestIds: getNearestIds(\n                  state.sortedData,\n                  state.settings.cellsCount,\n                  action.id\n               ),\n            };\n         } else {\n            return { ...state };\n         }\n      case RESET_NEAREST_IDS:\n         if (!!state.nearestIds.ids.length) {\n            return { ...state, nearestIds: defaultState.nearestIds };\n         } else {\n            return { ...state };\n         }\n      default:\n         return defaultState;\n   }\n};\n\nexport default matrixReducer;\n"]},"metadata":{},"sourceType":"module"}