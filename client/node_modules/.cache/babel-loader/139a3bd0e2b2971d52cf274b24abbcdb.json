{"ast":null,"code":"import { INCREMENT_CELL, REMOVE_ROW, ADD_ROW, SET_NEAREST_IDS, RESET_NEAREST_IDS, SET_SETTINGS, RESET_SETTINGS } from \"../action_types\";\nimport { createMatrix, rebuildMatrix, addRows } from \"./matrixReducer/buildingMatrix\";\nimport defaultState from \"./matrixReducer/defaultState\";\nimport getIds from \"./matrixReducer/findNearestIds\";\nconst initialState = defaultState;\n\nconst sortData = data => {\n  if (data.length > 0) {\n    return data.flat().sort((a, b) => a.value - b.value);\n  }\n}; //find nearest values functions\n\n\nconst checkTargetValueIsLowest = (sortedData, targetId) => {\n  if (sortedData.indexOf(sortedData.find(item => item.id === targetId)) === 0) {\n    return true;\n  }\n};\n\nconst incrementDataCell = (data, id) => {\n  let newData = [...data];\n  newData.find(row => row.find(item => item.id === id ? item.value++ : null));\n  return newData;\n};\n\nconst matrixReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case SET_SETTINGS:\n      let data = [...state.data];\n      const newSettings = { ...action.settings\n      };\n\n      if (state.data.length === 0) {\n        data = createMatrix(newSettings.rowsCount, newSettings.columnsCount);\n      } else if (state.settings.rowsCount !== newSettings.rowsCount || state.settings.columnsCount !== newSettings.columnsCount) {\n        data = rebuildMatrix([...state.data], state.settings, newSettings);\n      }\n\n      return { ...state,\n        data,\n        sortedData: sortData(data),\n        settings: newSettings\n      };\n\n    case RESET_SETTINGS:\n      return {\n        defaultState\n      };\n\n    case ADD_ROW:\n      return { ...state,\n        settings: { ...state.settings,\n          rowsCount: state.data.length\n        },\n        data: addRows([...state.data], 1, state.settings.columnsCount),\n        sortedData: sortData(state.data)\n      };\n\n    case REMOVE_ROW:\n      return { ...state,\n        settings: { ...state.settings,\n          rowsCount: state.data.length\n        },\n        data: state.data.filter((row, index) => index !== action.rowIndex),\n        sortedData: sortData(state.data)\n      };\n\n    case INCREMENT_CELL:\n      return { ...state,\n        data: incrementDataCell(state.data, action.id),\n        sortedData: sortData(state.data),\n        nearestIds: getIds(state.sortedData, state.settings.cellsCount, action.id)\n      };\n\n    case SET_NEAREST_IDS:\n      if (state.settings.cellsCount) {\n        return { ...state,\n          sortedData: sortData(state.data),\n          nearestIds: getIds(state.sortedData, state.settings.cellsCount, action.id)\n        };\n      } else {\n        return { ...state\n        };\n      }\n\n    case RESET_NEAREST_IDS:\n      if (!!state.nearestIds.ids.length) {\n        return { ...state,\n          nearestIds: {\n            sameValueIds: [],\n            ids: []\n          }\n        };\n      } else {\n        return { ...state\n        };\n      }\n\n    default:\n      return defaultState;\n  }\n};\n\nexport default matrixReducer;","map":{"version":3,"sources":["/home/superproger/workspace/matrix-builder/client/src/redux/reducers/matrixReducer.js"],"names":["INCREMENT_CELL","REMOVE_ROW","ADD_ROW","SET_NEAREST_IDS","RESET_NEAREST_IDS","SET_SETTINGS","RESET_SETTINGS","createMatrix","rebuildMatrix","addRows","defaultState","getIds","initialState","sortData","data","length","flat","sort","a","b","value","checkTargetValueIsLowest","sortedData","targetId","indexOf","find","item","id","incrementDataCell","newData","row","matrixReducer","state","action","type","newSettings","settings","rowsCount","columnsCount","filter","index","rowIndex","nearestIds","cellsCount","ids","sameValueIds"],"mappings":"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","sourcesContent":["import {\n   INCREMENT_CELL,\n   REMOVE_ROW,\n   ADD_ROW,\n   SET_NEAREST_IDS,\n   RESET_NEAREST_IDS,\n   SET_SETTINGS,\n   RESET_SETTINGS,\n} from \"../action_types\";\nimport { createMatrix, rebuildMatrix, addRows } from \"./matrixReducer/buildingMatrix\";\nimport defaultState from \"./matrixReducer/defaultState\";\nimport getIds from \"./matrixReducer/findNearestIds\";\n\nconst initialState = defaultState;\nconst sortData = (data) => {\n   if (data.length > 0) {\n      return data.flat().sort((a, b) => a.value - b.value);\n   }\n};\n\n//find nearest values functions\nconst checkTargetValueIsLowest = (sortedData, targetId) => {\n   if (\n      sortedData.indexOf(sortedData.find((item) => item.id === targetId)) === 0\n   ) {\n      return true;\n   }\n};\n\nconst incrementDataCell = (data, id) => {\n   let newData = [...data];\n   newData.find((row) =>\n      row.find((item) => (item.id === id ? item.value++ : null))\n   );\n   return newData;\n};\nconst matrixReducer = (state = initialState, action) => {\n   switch (action.type) {\n      case SET_SETTINGS:\n         let data = [...state.data];\n         const newSettings = { ...action.settings };\n         if (state.data.length === 0) {\n            data = createMatrix(\n               newSettings.rowsCount,\n               newSettings.columnsCount\n            );\n         } else if (\n            state.settings.rowsCount !== newSettings.rowsCount ||\n            state.settings.columnsCount !== newSettings.columnsCount\n         ) {\n            data = rebuildMatrix([...state.data], state.settings, newSettings);\n         }\n         return {\n            ...state,\n            data,\n            sortedData: sortData(data),\n            settings: newSettings,\n         };\n      case RESET_SETTINGS:\n         return {\n            defaultState,\n         };\n      case ADD_ROW:\n         return {\n            ...state,\n            settings: { ...state.settings, rowsCount: state.data.length },\n            data: addRows([...state.data], 1, state.settings.columnsCount),\n            sortedData: sortData(state.data),\n         };\n      case REMOVE_ROW:\n         return {\n            ...state,\n            settings: { ...state.settings, rowsCount: state.data.length },\n            data: state.data.filter((row, index) => index !== action.rowIndex),\n            sortedData: sortData(state.data),\n         };\n      case INCREMENT_CELL:\n         return {\n            ...state,\n            data: incrementDataCell(state.data, action.id),\n            sortedData: sortData(state.data),\n            nearestIds: getIds(\n               state.sortedData,\n               state.settings.cellsCount,\n               action.id\n            ),\n         };\n      case SET_NEAREST_IDS:\n         if (state.settings.cellsCount) {\n            return {\n               ...state,\n               sortedData: sortData(state.data),\n               nearestIds: getIds(\n                  state.sortedData,\n                  state.settings.cellsCount,\n                  action.id\n               ),\n            };\n         } else {\n            return { ...state };\n         }\n\n      case RESET_NEAREST_IDS:\n         if (!!state.nearestIds.ids.length) {\n            return { ...state, nearestIds: { sameValueIds: [], ids: [] } };\n         } else {\n            return { ...state };\n         }\n      default:\n         return defaultState;\n   }\n};\n\nexport default matrixReducer;\n"]},"metadata":{},"sourceType":"module"}