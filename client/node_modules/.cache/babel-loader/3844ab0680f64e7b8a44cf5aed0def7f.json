{"ast":null,"code":"import { setNearestIds } from \"../../actions\";\nimport { INCREMENT_CELL, REMOVE_ROW, ADD_ROW, SET_NEAREST_IDS, RESET_NEAREST_IDS, SET_SETTINGS, RESET_SETTINGS } from \"../../action_types\";\nimport { createMatrix, rebuildMatrix, addRows } from \"./buildingMatrix\";\nimport defaultState from \"./defaultState\";\nimport getIds from \"./findNearestIds\";\nconst initialState = defaultState;\n\nconst sortData = data => data.flat().sort((a, b) => a.value - b.value);\n\nconst checkMatrixData = (data, settings, newSettings) => {\n  if (data.length === 0) {\n    return createMatrix(newSettings.rowsCount, newSettings.columnsCount);\n  } else if (settings.rowsCount !== newSettings.rowsCount || settings.columnsCount !== newSettings.columnsCount) {\n    return rebuildMatrix(data, settings, newSettings);\n  } else {\n    return data;\n  }\n};\n\nconst getNearestIds = (data, cellsCount, id) => !!cellsCount ? getIds(data, cellsCount, id) : defaultState.nearestIds;\n\nconst matrixReducer = (state = initialState, action) => {\n  let data, sortedData, settings;\n\n  switch (action.type) {\n    case SET_SETTINGS:\n      data = checkMatrixData([...state.data], state.settings, action.settings);\n      return { ...state,\n        data,\n        sortedData: sortData(data),\n        settings: action.settings\n      };\n\n    case RESET_SETTINGS:\n      return {\n        defaultState\n      };\n\n    case ADD_ROW:\n      data = addRows([...state.data], 1, state.settings.columnsCount);\n      settings = { ...state.settings,\n        rowsCount: data.length\n      };\n      return { ...state,\n        settings,\n        data,\n        sortedData: sortData(data)\n      };\n\n    case REMOVE_ROW:\n      data = state.data.filter((row, index) => index !== action.rowIndex);\n      settings = { ...state.settings,\n        rowsCount: state.data.length\n      };\n      return { ...state,\n        settings,\n        data,\n        sortedData: sortData(data)\n      };\n\n    case INCREMENT_CELL:\n      data = [...state.data];\n      const incrementValue = data.flat().find(item => item.id === action.id).value;\n      incrementValue < 999 && data.find(row => row.find(item => item.id === action.id ? item.value++ : null));\n      sortedData = sortData(data);\n      return { ...state,\n        data,\n        sortedData,\n        nearestIds: setNearestIds(sortedData, state.settings.cellsCount, action.id)\n      };\n\n    case SET_NEAREST_IDS:\n      if (state.settings.cellsCount > 0) {\n        return { ...state,\n          nearestIds: setNearestIds(state.sortedData, state.settings.cellsCount, action.id)\n        };\n      } else {\n        return { ...state\n        };\n      }\n\n    case RESET_NEAREST_IDS:\n      if (!!state.nearestIds.ids.length) {\n        return { ...state,\n          nearestIds: defaultState.nearestIds\n        };\n      } else {\n        return { ...state\n        };\n      }\n\n    default:\n      return defaultState;\n  }\n};\n\nexport default matrixReducer;","map":{"version":3,"sources":["/home/superproger/workspace/matrix-builder/client/src/redux/reducers/matrixReducer/index.js"],"names":["setNearestIds","INCREMENT_CELL","REMOVE_ROW","ADD_ROW","SET_NEAREST_IDS","RESET_NEAREST_IDS","SET_SETTINGS","RESET_SETTINGS","createMatrix","rebuildMatrix","addRows","defaultState","getIds","initialState","sortData","data","flat","sort","a","b","value","checkMatrixData","settings","newSettings","length","rowsCount","columnsCount","getNearestIds","cellsCount","id","nearestIds","matrixReducer","state","action","sortedData","type","filter","row","index","rowIndex","incrementValue","find","item","ids"],"mappings":"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","sourcesContent":["import { setNearestIds } from \"../../actions\";\nimport {\n   INCREMENT_CELL,\n   REMOVE_ROW,\n   ADD_ROW,\n   SET_NEAREST_IDS,\n   RESET_NEAREST_IDS,\n   SET_SETTINGS,\n   RESET_SETTINGS,\n} from \"../../action_types\";\nimport { createMatrix, rebuildMatrix, addRows } from \"./buildingMatrix\";\nimport defaultState from \"./defaultState\";\nimport getIds from \"./findNearestIds\";\n\nconst initialState = defaultState;\nconst sortData = (data) => data.flat().sort((a, b) => a.value - b.value);\n\nconst checkMatrixData = (data, settings, newSettings) => {\n   if (data.length === 0) {\n      return createMatrix(newSettings.rowsCount, newSettings.columnsCount);\n   } else if (\n      settings.rowsCount !== newSettings.rowsCount ||\n      settings.columnsCount !== newSettings.columnsCount\n   ) {\n      return rebuildMatrix(data, settings, newSettings);\n   } else {\n      return data;\n   }\n};\nconst getNearestIds = (data, cellsCount, id) =>\n   !!cellsCount ? getIds(data, cellsCount, id) : defaultState.nearestIds;\n\nconst matrixReducer = (state = initialState, action) => {\n   let data, sortedData, settings;\n   switch (action.type) {\n      case SET_SETTINGS:\n         data = checkMatrixData(\n            [...state.data],\n            state.settings,\n            action.settings\n         );\n         return {\n            ...state,\n            data,\n            sortedData: sortData(data),\n            settings: action.settings,\n         };\n      case RESET_SETTINGS:\n         return {\n            defaultState,\n         };\n      case ADD_ROW:\n         data = addRows([...state.data], 1, state.settings.columnsCount);\n         settings = { ...state.settings, rowsCount: data.length };\n         return {\n            ...state,\n            settings,\n            data,\n            sortedData: sortData(data),\n         };\n      case REMOVE_ROW:\n         data = state.data.filter((row, index) => index !== action.rowIndex);\n         settings = { ...state.settings, rowsCount: state.data.length };\n         return {\n            ...state,\n            settings,\n            data,\n            sortedData: sortData(data),\n         };\n      case INCREMENT_CELL:\n         data = [...state.data];\n         const incrementValue = data\n            .flat()\n            .find((item) => item.id === action.id).value;\n         incrementValue < 999 &&\n            data.find((row) =>\n               row.find((item) => (item.id === action.id ? item.value++ : null))\n            );\n         sortedData = sortData(data);\n         return {\n            ...state,\n            data,\n            sortedData,\n            nearestIds: setNearestIds(\n               sortedData,\n               state.settings.cellsCount,\n               action.id\n            ),\n         };\n      case SET_NEAREST_IDS:\n         if (state.settings.cellsCount > 0) {\n            return {\n               ...state,\n               nearestIds: setNearestIds(\n                  state.sortedData,\n                  state.settings.cellsCount,\n                  action.id\n               ),\n            };\n         } else {\n            return { ...state };\n         }\n      case RESET_NEAREST_IDS:\n         if (!!state.nearestIds.ids.length) {\n            return { ...state, nearestIds: defaultState.nearestIds };\n         } else {\n            return { ...state };\n         }\n      default:\n         return defaultState;\n   }\n};\n\nexport default matrixReducer;\n"]},"metadata":{},"sourceType":"module"}